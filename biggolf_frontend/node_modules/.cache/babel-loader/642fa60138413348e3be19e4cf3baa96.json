{"ast":null,"code":"/**\n * @author shaozilee\n *\n * BMP format encoder,encode 24bit BMP\n * Not support quality compression\n *\n */\n\nfunction BmpEncoder(imgData) {\n  this.buffer = imgData.data;\n  this.width = imgData.width;\n  this.height = imgData.height;\n  this.extraBytes = this.width % 4;\n  this.rgbSize = this.height * (3 * this.width + this.extraBytes);\n  this.headerInfoSize = 40;\n  this.data = [];\n  /******************header***********************/\n  this.flag = \"BM\";\n  this.reserved = 0;\n  this.offset = 54;\n  this.fileSize = this.rgbSize + this.offset;\n  this.planes = 1;\n  this.bitPP = 24;\n  this.compress = 0;\n  this.hr = 0;\n  this.vr = 0;\n  this.colors = 0;\n  this.importantColors = 0;\n}\nBmpEncoder.prototype.encode = function () {\n  var tempBuffer = new Buffer(this.offset + this.rgbSize);\n  this.pos = 0;\n  tempBuffer.write(this.flag, this.pos, 2);\n  this.pos += 2;\n  tempBuffer.writeUInt32LE(this.fileSize, this.pos);\n  this.pos += 4;\n  tempBuffer.writeUInt32LE(this.reserved, this.pos);\n  this.pos += 4;\n  tempBuffer.writeUInt32LE(this.offset, this.pos);\n  this.pos += 4;\n  tempBuffer.writeUInt32LE(this.headerInfoSize, this.pos);\n  this.pos += 4;\n  tempBuffer.writeUInt32LE(this.width, this.pos);\n  this.pos += 4;\n  tempBuffer.writeInt32LE(-this.height, this.pos);\n  this.pos += 4;\n  tempBuffer.writeUInt16LE(this.planes, this.pos);\n  this.pos += 2;\n  tempBuffer.writeUInt16LE(this.bitPP, this.pos);\n  this.pos += 2;\n  tempBuffer.writeUInt32LE(this.compress, this.pos);\n  this.pos += 4;\n  tempBuffer.writeUInt32LE(this.rgbSize, this.pos);\n  this.pos += 4;\n  tempBuffer.writeUInt32LE(this.hr, this.pos);\n  this.pos += 4;\n  tempBuffer.writeUInt32LE(this.vr, this.pos);\n  this.pos += 4;\n  tempBuffer.writeUInt32LE(this.colors, this.pos);\n  this.pos += 4;\n  tempBuffer.writeUInt32LE(this.importantColors, this.pos);\n  this.pos += 4;\n  var i = 0;\n  var rowBytes = 3 * this.width + this.extraBytes;\n  for (var y = 0; y < this.height; y++) {\n    for (var x = 0; x < this.width; x++) {\n      var p = this.pos + y * rowBytes + x * 3;\n      i++; //a\n      tempBuffer[p] = this.buffer[i++]; //b\n      tempBuffer[p + 1] = this.buffer[i++]; //g\n      tempBuffer[p + 2] = this.buffer[i++]; //r\n    }\n\n    if (this.extraBytes > 0) {\n      var fillOffset = this.pos + y * rowBytes + this.width * 3;\n      tempBuffer.fill(0, fillOffset, fillOffset + this.extraBytes);\n    }\n  }\n  return tempBuffer;\n};\nmodule.exports = function (imgData, quality) {\n  if (typeof quality === 'undefined') quality = 100;\n  var encoder = new BmpEncoder(imgData);\n  var data = encoder.encode();\n  return {\n    data: data,\n    width: imgData.width,\n    height: imgData.height\n  };\n};","map":{"version":3,"names":["BmpEncoder","imgData","buffer","data","width","height","extraBytes","rgbSize","headerInfoSize","flag","reserved","offset","fileSize","planes","bitPP","compress","hr","vr","colors","importantColors","prototype","encode","tempBuffer","Buffer","pos","write","writeUInt32LE","writeInt32LE","writeUInt16LE","i","rowBytes","y","x","p","fillOffset","fill","module","exports","quality","encoder"],"sources":["C:/Users/Daniel/node_modules/appium/node_modules/bmp-js/lib/encoder.js"],"sourcesContent":["/**\n * @author shaozilee\n *\n * BMP format encoder,encode 24bit BMP\n * Not support quality compression\n *\n */\n\nfunction BmpEncoder(imgData){\n\tthis.buffer = imgData.data;\n\tthis.width = imgData.width;\n\tthis.height = imgData.height;\n\tthis.extraBytes = this.width%4;\n\tthis.rgbSize = this.height*(3*this.width+this.extraBytes);\n\tthis.headerInfoSize = 40;\n\n\tthis.data = [];\n\t/******************header***********************/\n\tthis.flag = \"BM\";\n\tthis.reserved = 0;\n\tthis.offset = 54;\n\tthis.fileSize = this.rgbSize+this.offset;\n\tthis.planes = 1;\n\tthis.bitPP = 24;\n\tthis.compress = 0;\n\tthis.hr = 0;\n\tthis.vr = 0;\n\tthis.colors = 0;\n\tthis.importantColors = 0;\n}\n\nBmpEncoder.prototype.encode = function() {\n\tvar tempBuffer = new Buffer(this.offset+this.rgbSize);\n\tthis.pos = 0;\n\ttempBuffer.write(this.flag,this.pos,2);this.pos+=2;\n\ttempBuffer.writeUInt32LE(this.fileSize,this.pos);this.pos+=4;\n\ttempBuffer.writeUInt32LE(this.reserved,this.pos);this.pos+=4;\n\ttempBuffer.writeUInt32LE(this.offset,this.pos);this.pos+=4;\n\n\ttempBuffer.writeUInt32LE(this.headerInfoSize,this.pos);this.pos+=4;\n\ttempBuffer.writeUInt32LE(this.width,this.pos);this.pos+=4;\n\ttempBuffer.writeInt32LE(-this.height,this.pos);this.pos+=4;\n\ttempBuffer.writeUInt16LE(this.planes,this.pos);this.pos+=2;\n\ttempBuffer.writeUInt16LE(this.bitPP,this.pos);this.pos+=2;\n\ttempBuffer.writeUInt32LE(this.compress,this.pos);this.pos+=4;\n\ttempBuffer.writeUInt32LE(this.rgbSize,this.pos);this.pos+=4;\n\ttempBuffer.writeUInt32LE(this.hr,this.pos);this.pos+=4;\n\ttempBuffer.writeUInt32LE(this.vr,this.pos);this.pos+=4;\n\ttempBuffer.writeUInt32LE(this.colors,this.pos);this.pos+=4;\n\ttempBuffer.writeUInt32LE(this.importantColors,this.pos);this.pos+=4;\n\n\tvar i=0;\n\tvar rowBytes = 3*this.width+this.extraBytes;\n\n\tfor (var y = 0; y <this.height; y++){\n\t\tfor (var x = 0; x < this.width; x++){\n\t\t\tvar p = this.pos+y*rowBytes+x*3;\n\t\t\ti++;//a\n\t\t\ttempBuffer[p]= this.buffer[i++];//b\n\t\t\ttempBuffer[p+1] = this.buffer[i++];//g\n\t\t\ttempBuffer[p+2]  = this.buffer[i++];//r\n\t\t}\n\t\tif(this.extraBytes>0){\n\t\t\tvar fillOffset = this.pos+y*rowBytes+this.width*3;\n\t\t\ttempBuffer.fill(0,fillOffset,fillOffset+this.extraBytes);\n\t\t}\n\t}\n\n\treturn tempBuffer;\n};\n\nmodule.exports = function(imgData, quality) {\n  if (typeof quality === 'undefined') quality = 100;\n \tvar encoder = new BmpEncoder(imgData);\n\tvar data = encoder.encode();\n  return {\n    data: data,\n    width: imgData.width,\n    height: imgData.height\n  };\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}